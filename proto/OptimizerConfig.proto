syntax = "proto2";
 
option optimize_for = LITE_RUNTIME;

package paddle;

message SGDConfig {
  // SGD 
  // learning_rate: float >= 0. Learning rate.
  // momentum: float >= 0. Parameter updates momentum.
  // decay: float >= 0. Learning rate decay over each update.
  // nesterov: boolean. Whether to apply Nesterov momentum.
  required double learning_rate = 20 [default = 1.0];
  optional double momentum = 21 [default = 0.0];
  optional double decay = 23;
  optional bool nesterov =24;
}


message AdadeltaConfig {
// Adadelta
// learning_rate: float >= 0. Learning rate.
// It is recommended to leave it at the default value.
// rho: float >= 0.
// epsilon: float >= 0. Fuzz factor.
// decay: float >= 0. Learning rate decay over each update.

// reference : [Adadelta - an adaptive learning rate method](http://arxiv.org/abs/1212.5701)
  required double learning_rate = 30 [default = 1.0];
  optional double rho = 33;
  optional double epsilon = 31;
  optional double decay = 32;

}

message AdagradConfig {
// Adagrad
// learning_rate: float >= 0. Learning rate.
// epsilon: float >= 0.
// decay: float >= 0. Learning rate decay over each update.

// reference : [Adaptive Subgradient Methods for Online Learning and Stochastic Optimization](http://www.jmlr.org/papers/volume12/duchi11a/duchi11a.pdf)
  required double learning_rate = 30 [default = 1.0];
  optional double epsilon = 31;
  optional double decay = 32;
}

message AdamConfig {
  // Adaj
  // learning_rate: float >= 0. Learning rate.
  // beta_1: float, 0 < beta < 1. Generally close to 1.
  // beta_2: float, 0 < beta < 1. Generally close to 1.
  // epsilon: float >= 0. Fuzz factor.
  // decay: float >= 0. Learning rate decay over each update.
  // reference : [Adam - A Method for Stochastic Optimization](http://arxiv.org/abs/1412.6980v8)
  required double learning_rate = 40 [default = 1.0];
  optional double beta_1 = 41;
  optional double beta_2 = 42;
  optional double epsilon = 43;
}


message OptimizerConfig {
  // common config of optimizer
  required string optimizer_name = 1;
  // algorithm config
  enum OptimizerType {
    SGD = 1;
    Adadelta = 2;
    Adagrad = 3;
    Adam = 4;
  }
  required OptimizerType optimizer_type = 2;
  optional SGDConfig sgd = 3;
  optional AdadeltaConfig adadelta = 4;
  optional AdagradConfig adagrad = 5;
  optional AdamConfig adam = 6;

  // learning rate runtime policy config
  enum LearningRateType {
    Linear = 1;
    Exp = 2;
    Poly = 3;
    CaffePoly = 4;
  }
  required LearningRateType lr_type = 11;
  optional uint32 num_sample_passed = 12 [default = 0];
  optional uint32 iterations = 13;

  // reqularizer config
  enum RegularizerType {
    L1 = 1;
    L2 = 2;
    L1L2 = 3;
  }
  optional RegularizerType regularizer_type = 21;
  
  // common config of optimizer
  optional double clipnorm = 101;
  optional double clipvalue = 102;

}
