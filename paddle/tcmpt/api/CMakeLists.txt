add_subdirectory(src)

# set(declare_file ${PADDLE_BINARY_DIR}/paddle/tcmpt/api/symbols.h.tmp CACHE INTERNAL "symbols.h file")
# set(declare_file_final ${PADDLE_BINARY_DIR}/paddle/tcmpt/api/symbols.h)
# file(WRITE ${declare_file} "// Generated by the paddle/tcmpt/api/CMakeLists.txt.  DO NOT EDIT!\n\n")

# function(declare_module TARGTE)
#     file(APPEND ${declare_file} "extern int RegisterSymbolsFor${TARGET}();\n")
#     message(STATUS "")
# endfunction()

set(TCMPT_DEPS convert_utils dense_tensor selected_rows_tensor kernel_factory kernel_context)
set(TCMPT_DEPS ${TCMPT_DEPS} math_cpu linalg_cpu)
if(WITH_GPU OR WITH_ROCM)
  set(TCMPT_DEPS ${TCMPT_DEPS} math_cuda linalg_cuda)
endif()

set(TCMPT_DEPS ${TCMPT_DEPS} math_api linalg_api)

# TODO(chenweihang): unify decclare into **_library
# declare_module(MathCPU)
# declare_module(MathCUDA)

cc_library(tcmpt SRCS all.cc DEPS ${TCMPT_DEPS})

# copy_if_different(${declare_file} ${declare_file_final})
