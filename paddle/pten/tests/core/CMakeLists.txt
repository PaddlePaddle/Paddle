cc_test(test_dense_tensor SRCS test_dense_tensor.cc DEPS dense_tensor)
cc_test(test_intrusive_ptr SRCS test_intrusive_ptr.cc)
cc_test(test_type_info SRCS test_type_info.cc)
cc_test(test_convert_utils SRCS test_convert_utils.cc DEPS convert_utils)
cc_test(test_kernel_factory SRCS test_kernel_factory.cc DEPS kernel_factory scale_kernel)
cc_test(test_sparse_csr_tensor SRCS test_sparse_csr_tensor.cc DEPS dense_tensor sparse_csr_tensor)
cc_test(test_pten_device_context SRCS test_device_context.cc DEPS pten_context cpu_context)

cc_test(test_ddim SRCS test_ddim.cc DEPS ddim)
if(WITH_GPU)
  nv_test(test_dim SRCS test_dim.cu DEPS ddim)
elseif(WITH_ROCM)
  hip_test(test_dim SRCS test_dim.cu DEPS ddim)
endif()

cc_test(selected_rows_test SRCS test_selected_rows.cc DEPS selected_rows)
if(WITH_TESTING AND TEST selected_rows_test)
  set_tests_properties(selected_rows_test PROPERTIES TIMEOUT 120)
endif()
if (NOT WIN32)
cc_test(test_rw_lock SRCS test_rw_lock.cc)
endif (NOT WIN32)
